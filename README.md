PostgreSQL Planner Hint Generator
==================================

This command line tool gets planner hints for PostgreSQL from SQL, instead of getting the query results. The generated planner hints can be used with [pg_hint_plan](http://pghintplan.osdn.jp/) extension module.

## Installation

To install phint, run:

```bash
$ go get github.com/MasahikoSawada/phint
```

Make sure your `PATH` includes the `$GOPATH/bin` directory so your commands can be easily used:

```bash
export PATH=$PATH:$GOPATH/bin
```

To use planner hints in PostgreSQL you can use [pg_hint_plan](http://pghintplan.osdn.jp/) extension module, which enables us to planner hints in PostgreSQL.

## Usage

Run `phint` like `psql` command:

```bash
$ phint --host localhost -p 5432 -d mydb -c "SELECT * FROM tbl1, tbl2 WHERE tbl1.id = tbl2.id AND tbl1.id < 1000"
```

then you will get planner hints with SQL in stdout:

```
/*+
Leading((tbl2 tbl1))
HashJoin(tbl2 tbl1)
SeqScan(tbl2)
IndexScan(tbl1 tbl1_pkey)
*/
EXPLAIN SELECT * FROM tbl1, tbl2 WHERE tbl1.id = tbl2.id AND tbl1.id < 1000
```

You can also execute SQL command from file using `-f` option:

```bash
$ vi /path/to/sample.sql
SELECT * FROM tbl1, tbl2 WHERE tbl1.id = tbl2.id AND tbl1.id < 1000
$ phint --host localhost -p 5432 -d mydb -f /path/to/sample.sql
/*+
Leading((tbl2 tbl1))
HashJoin(tbl2 tbl1)
SeqScan(tbl2)
IndexScan(tbl1 tbl1_pkey)
*/
EXPLAIN SELECT * FROM tbl1, tbl2 WHERE tbl1.id = tbl2.id AND tbl1.id < 1000
```

## Using with pg_hint_plan

phint itself doesn't require pg_hint_plan for execution. However, PostgreSQL requires pg_hint_plan to use planner hint and phint generates planner hints that can be used by pg_hint_plan. So please install pg_hint_plan when you use planner hint generated by phint.

# Tested version
* PostgreSQL 9.6 or later
